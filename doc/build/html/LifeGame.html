<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>HowTo Project: LifeGame &mdash; Synergine 0.0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Synergine 0.0.1 documentation" href="index.html" />
    <link rel="next" title="Builtin Modules" href="BuiltinModules.html" />
    <link rel="prev" title="Components" href="Components.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="BuiltinModules.html" title="Builtin Modules"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Components.html" title="Components"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Synergine 0.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="howto-project-lifegame">
<h1>HowTo Project: LifeGame<a class="headerlink" href="#howto-project-lifegame" title="Permalink to this headline">¶</a></h1>
<div class="section" id="objective">
<h2>Objective<a class="headerlink" href="#objective" title="Permalink to this headline">¶</a></h2>
<p>This howto will help you to discover synergine with a simple implementation. We will only show you the code of main
logic. But all not displayed code here is described in main documentation. TODO: lien vers builtin modules</p>
<p>The howto project implement the &#8220;Conway&#8217;s Game of Life&#8221;.</p>
<p>From Wikipedia, the free encyclopedia:</p>
<div class="highlight-python"><div class="highlight"><pre>The Game of Life, also known simply as Life, is a cellular automaton devised by
the British mathematician John Horton Conway in 1970.

The &quot;game&quot; is a zero-player game, meaning that its evolution is determined by
its initial state, requiring no further input. One interacts with the Game of
Life by creating an initial configuration and observing how it evolves or, for
advanced players, by creating patterns with particular properties.
</pre></div>
</div>
</div>
<div class="section" id="content-of-simulation">
<h2>Content of simulation<a class="headerlink" href="#content-of-simulation" title="Permalink to this headline">¶</a></h2>
<p>Our simulation will simply implement a basic pattern of &#8220;Conway&#8217;s Game of Life&#8221; and visualisation tools.</p>
<div class="section" id="simulation">
<h3>Simulation<a class="headerlink" href="#simulation" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This project wil use some code of builtin module &#8220;xyzworld&#8221;. TODO: link</p>
</div>
<p>The objective is to implement the rules of &#8220;Conway&#8217;s Game of Life&#8221;.
From Wikipedia, the free encyclopedia:</p>
<div class="highlight-python"><div class="highlight"><pre>The universe of the Game of Life is an infinite two-dimensional orthogonal
grid of square cells, each of which is in one of two possible states, alive
or dead. Every cell interacts with its eight neighbours, which are the
cells that are horizontally, vertically, or diagonally adjacent. At each
step in time, the following transitions occur:

1. Any live cell with fewer than two live neighbours dies, as if caused by
   under-population.
2. Any live cell with two or three live neighbours lives on to the next generation.
3. Any live cell with more than three live neighbours dies, as if by overcrowding.
4. Any dead cell with exactly three live neighbours becomes a live cell, as if by
   reproduction.

The initial pattern constitutes the seed of the system. The first generation
is created by applying the above rules simultaneously to every cell in the
seed—births and deaths occur simultaneously, and the discrete moment at which
this happens is sometimes called a tick (in other words, each generation is a
pure function of the preceding one). The rules continue to be applied repeatedly
to create further generations.
</pre></div>
</div>
</div>
<div class="section" id="additional-features">
<h3>Additional features<a class="headerlink" href="#additional-features" title="Permalink to this headline">¶</a></h3>
<p>In additional of &#8220;Conway&#8217;s Game of Life&#8221; rules, we will represent differently in our 2d graphic output:</p>
<ul class="simple">
<li>A just born cell</li>
<li>A born cell since 2 cycles</li>
<li>A born cell since more 2 cycles</li>
</ul>
</div>
<div class="section" id="synergyobjects">
<h3>SynergyObjects<a class="headerlink" href="#synergyobjects" title="Permalink to this headline">¶</a></h3>
<p>We need: A Cell.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">lifegame.cst</span> <span class="kn">import</span> <span class="n">COL_ALL</span><span class="p">,</span> <span class="n">DIED</span><span class="p">,</span> <span class="n">ALIVE</span><span class="p">,</span> <span class="n">COL_DIED</span><span class="p">,</span> <span class="n">COL_ALIVE</span>
<span class="kn">from</span> <span class="nn">xyzworld.SynergyObject</span> <span class="kn">import</span> <span class="n">SynergyObject</span> <span class="k">as</span> <span class="n">XyzSynergyObject</span>


<span class="k">class</span> <span class="nc">Cell</span><span class="p">(</span><span class="n">XyzSynergyObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Representation of cell.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        :param collection: Collection who contain this Cell</span>
<span class="sd">        :param context: The context object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_alive</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_alive_since</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">context</span><span class="o">.</span><span class="n">metas</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_id</span><span class="p">(),</span> <span class="n">COL_ALL</span><span class="p">)</span>
        <span class="n">context</span><span class="o">.</span><span class="n">metas</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_id</span><span class="p">(),</span> <span class="n">COL_DIED</span><span class="p">)</span>
        <span class="n">context</span><span class="o">.</span><span class="n">metas</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_id</span><span class="p">(),</span> <span class="n">DIED</span><span class="p">)</span>  <span class="c"># By default, a cell is dead</span>

    <span class="k">def</span> <span class="nf">set_alive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alive</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Change the state of Cell.</span>

<span class="sd">        :param alive: Foo</span>
<span class="sd">        :return: Void</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c">#  When alive state of Cell change, self._alive is reinitialized</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_alive_since</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_alive</span> <span class="o">=</span> <span class="n">alive</span>

        <span class="c"># We update states to.</span>
        <span class="k">if</span> <span class="n">alive</span><span class="p">:</span>
            <span class="c"># State of cell is now ALIVE</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="o">.</span><span class="n">metas</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">add_remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_id</span><span class="p">(),</span> <span class="n">ALIVE</span><span class="p">,</span> <span class="n">DIED</span><span class="p">)</span>
            <span class="c"># Cell is now in COL_ALIVE collection</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="o">.</span><span class="n">metas</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_id</span><span class="p">(),</span> <span class="n">COL_ALIVE</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="o">.</span><span class="n">metas</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_id</span><span class="p">(),</span> <span class="n">COL_DIED</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># State of cell is now DIED</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="o">.</span><span class="n">metas</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">add_remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_id</span><span class="p">(),</span> <span class="n">DIED</span><span class="p">,</span> <span class="n">ALIVE</span><span class="p">)</span>
            <span class="c"># Cell is now in COL_DIED collection</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="o">.</span><span class="n">metas</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_id</span><span class="p">(),</span> <span class="n">COL_DIED</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="o">.</span><span class="n">metas</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_id</span><span class="p">(),</span> <span class="n">COL_ALIVE</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_alive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alive</span>

    <span class="k">def</span> <span class="nf">get_is_alive_since</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        :return: Count of alive cycles.</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alive_since</span>

    <span class="k">def</span> <span class="nf">end_cycle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        At each cycle, cell is more older if it&#39;s alive.</span>

<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_alive_since</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Cell class is a child class of <a class="reference external" href="ModuleXyzworld.html#xyzworld.SynergyObject.SynergyObject">xyzworld.SynergyObject.SynergyObject</a>.</p>
</div>
<p>And no more for our SynergyObjects.</p>
</div>
<div class="section" id="events-and-actions">
<h3>Events and Actions<a class="headerlink" href="#events-and-actions" title="Permalink to this headline">¶</a></h3>
<div class="section" id="alivearoundevent">
<h4>AliveAroundEvent<a class="headerlink" href="#alivearoundevent" title="Permalink to this headline">¶</a></h4>
<p>Events/Actions will be &#8220;born&#8221; and &#8220;die&#8221;. These actions will need to know how many alice cells are around the concerned
cell. So we write AliveAroundEvent event:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">synergine.core.exceptions</span> <span class="kn">import</span> <span class="n">NotConcernedEvent</span>
<span class="kn">from</span> <span class="nn">xyzworld.mechanism.AroundMechanism</span> <span class="kn">import</span> <span class="n">AroundMechanism</span>
<span class="kn">from</span> <span class="nn">synergine.synergy.event.ContactEvent</span> <span class="kn">import</span> <span class="n">ContactEvent</span>
<span class="kn">from</span> <span class="nn">lifegame.cst</span> <span class="kn">import</span> <span class="n">ALIVE</span><span class="p">,</span> <span class="n">COL_DIED</span>


<span class="k">class</span> <span class="nc">AliveAroundEvent</span><span class="p">(</span><span class="n">ContactEvent</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class is a refactored class for die and born events.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_get_alive_cell_around_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
        <span class="n">cell_near_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c">#  parameters dict is prepared by mechanism</span>
        <span class="k">for</span> <span class="n">object_id_near</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">[</span><span class="s">&#39;objects_ids_near&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">metas</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">have</span><span class="p">(</span><span class="n">object_id_near</span><span class="p">,</span> <span class="n">ALIVE</span><span class="p">):</span>
                <span class="n">cell_near_count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">cell_near_count</span>
</pre></div>
</div>
<p>Ou born and die event will be child of this event.</p>
</div>
<div class="section" id="born">
<h4>Born<a class="headerlink" href="#born" title="Permalink to this headline">¶</a></h4>
<p>The born event:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">lifegame.synergy.event.AliveAroundEvent</span> <span class="kn">import</span> <span class="n">AliveAroundEvent</span>
<span class="kn">from</span> <span class="nn">synergine.core.exceptions</span> <span class="kn">import</span> <span class="n">NotConcernedEvent</span>
<span class="kn">from</span> <span class="nn">xyzworld.mechanism.AroundMechanism</span> <span class="kn">import</span> <span class="n">AroundMechanism</span>
<span class="kn">from</span> <span class="nn">lifegame.cst</span> <span class="kn">import</span> <span class="n">ALIVE</span><span class="p">,</span> <span class="n">COL_DIED</span>


<span class="k">class</span> <span class="nc">GoodConditionToBornEvent</span><span class="p">(</span><span class="n">AliveAroundEvent</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This event is applied when born condition are here. So when exactly 3 alive cell are around of observed cell.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">concern</span> <span class="o">=</span> <span class="n">COL_DIED</span>
    <span class="sd">&quot;&quot;&quot;This event only concern died cells.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actions</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
        <span class="c">#  This event need to know what is around concerned cell. So we use AroundMechanism who give us list of around</span>
        <span class="c"># objects ids.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mechanism</span> <span class="o">=</span> <span class="n">AroundMechanism</span>

    <span class="k">def</span> <span class="nf">_prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_id</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        According to “Conway’s Game of Life”, event match if exactly 3 around cell are alive.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cell_near_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_alive_cell_around_count</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cell_near_count</span> <span class="ow">is</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">parameters</span>
        <span class="c">#  If event not match, we must raise an NotConcernedEvent.</span>
        <span class="k">raise</span> <span class="n">NotConcernedEvent</span><span class="p">()</span>
</pre></div>
</div>
<p>And his action:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">synergine.synergy.event.Action</span> <span class="kn">import</span> <span class="n">Action</span>
<span class="kn">from</span> <span class="nn">lifegame.synergy.event.GoodConditionToBornEvent</span> <span class="kn">import</span> <span class="n">GoodConditionToBornEvent</span>


<span class="k">class</span> <span class="nc">BornAction</span><span class="p">(</span><span class="n">Action</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This action change state of Cell into alive.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_listen</span> <span class="o">=</span> <span class="n">GoodConditionToBornEvent</span>
    <span class="sd">&quot;&quot;&quot;This action listen the GoodConditionToBornEvent&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">synergy_manager</span><span class="p">):</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">set_alive</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="die">
<h4>Die<a class="headerlink" href="#die" title="Permalink to this headline">¶</a></h4>
<p>The die event:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">lifegame.synergy.event.AliveAroundEvent</span> <span class="kn">import</span> <span class="n">AliveAroundEvent</span>
<span class="kn">from</span> <span class="nn">synergine.core.exceptions</span> <span class="kn">import</span> <span class="n">NotConcernedEvent</span>
<span class="kn">from</span> <span class="nn">xyzworld.mechanism.AroundMechanism</span> <span class="kn">import</span> <span class="n">AroundMechanism</span>
<span class="kn">from</span> <span class="nn">lifegame.cst</span> <span class="kn">import</span> <span class="n">ALIVE</span><span class="p">,</span> <span class="n">COL_ALIVE</span>


<span class="k">class</span> <span class="nc">NotGoodConditionToPersistEvent</span><span class="p">(</span><span class="n">AliveAroundEvent</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This event is applied when die condition are here. So when less of 2 or more of 3 alive cell are around</span>
<span class="sd">    of observed cell.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">concern</span> <span class="o">=</span> <span class="n">COL_ALIVE</span>
    <span class="sd">&quot;&quot;&quot;This event only concern alive cells.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actions</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
        <span class="c">#  This event need to know what is around concerned cell. So we use AroundMechanism who give us list of around</span>
        <span class="c"># objects ids.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mechanism</span> <span class="o">=</span> <span class="n">AroundMechanism</span>

    <span class="k">def</span> <span class="nf">_prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_id</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        According to “Conway’s Game of Life”, event match if less of 2 or more of 3 alive cell are around.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cell_near_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_alive_cell_around_count</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cell_near_count</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">cell_near_count</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">parameters</span>
        <span class="c">#  If event not match, we must raise an NotConcernedEvent.</span>
        <span class="k">raise</span> <span class="n">NotConcernedEvent</span><span class="p">()</span>
</pre></div>
</div>
<p>And his action:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">synergine.synergy.event.Action</span> <span class="kn">import</span> <span class="n">Action</span>
<span class="kn">from</span> <span class="nn">lifegame.synergy.event.NotGoodConditionToPersistEvent</span> <span class="kn">import</span> <span class="n">NotGoodConditionToPersistEvent</span>


<span class="k">class</span> <span class="nc">DieAction</span><span class="p">(</span><span class="n">Action</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This action change state of Cell into died.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_listen</span> <span class="o">=</span> <span class="n">NotGoodConditionToPersistEvent</span>
    <span class="sd">&quot;&quot;&quot;This action listen the NotGoodConditionToPersistEvent&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">synergy_manager</span><span class="p">):</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">set_alive</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="aroundmechanism">
<h4>AroundMechanism<a class="headerlink" href="#aroundmechanism" title="Permalink to this headline">¶</a></h4>
<p>As you can see, these events uses the <a class="reference external" href="ModuleXyzworld.html#xyzworld.mechanism.AroundMechanism.AroundMechanism">AroundMechanism</a>. This mechanism prepare a list of object ids who are around the observed object.</p>
</div>
</div>
<div class="section" id="collection">
<h3>Collection<a class="headerlink" href="#collection" title="Permalink to this headline">¶</a></h3>
<p>Our Cells must be contained by a Collection.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">synergine.synergy.collection.SynergyCollection</span> <span class="kn">import</span> <span class="n">SynergyCollection</span>
<span class="kn">from</span> <span class="nn">lifegame.synergy.event.DieAction</span> <span class="kn">import</span> <span class="n">DieAction</span>
<span class="kn">from</span> <span class="nn">lifegame.synergy.event.BornAction</span> <span class="kn">import</span> <span class="n">BornAction</span>
<span class="kn">from</span> <span class="nn">lifegame.synergy.event.TimePassAction</span> <span class="kn">import</span> <span class="n">TimePassAction</span>


<span class="k">class</span> <span class="nc">LifeGameCollection</span><span class="p">(</span><span class="n">SynergyCollection</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This collection own cells of simulation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">configuration</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">configuration</span><span class="p">)</span>
        <span class="c"># We list here actions who concern our simulation.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_actions</span> <span class="o">=</span> <span class="p">[</span><span class="n">DieAction</span><span class="p">,</span> <span class="n">BornAction</span><span class="p">,</span> <span class="n">TimePassAction</span><span class="p">]</span>
</pre></div>
</div>
<p>The collection must have a configuration (to populate his synergies objects).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">synergine.synergy.collection.Configuration</span> <span class="kn">import</span> <span class="n">Configuration</span>
<span class="kn">from</span> <span class="nn">lifegame.synergy.object.Cell</span> <span class="kn">import</span> <span class="n">Cell</span>


<span class="k">class</span> <span class="nc">LifeGameCollectionConfiguration</span><span class="p">(</span><span class="n">Configuration</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">get_start_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="n">cells</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c"># We build a grid of 40x50 cells</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">40</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
                <span class="n">cell</span> <span class="o">=</span> <span class="n">Cell</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
                <span class="n">cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>

        <span class="c"># We define some position for alive cells</span>
        <span class="n">alive_cell_positions</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">22</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c"># And we born these alive cell</span>
        <span class="k">for</span> <span class="n">dead_cell</span> <span class="ow">in</span> <span class="n">cells</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dead_cell</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span> <span class="ow">in</span> <span class="n">alive_cell_positions</span><span class="p">:</span>
                <span class="n">dead_cell</span><span class="o">.</span><span class="n">set_alive</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

        <span class="c"># Synergy objects can be return to the collection</span>
        <span class="k">return</span> <span class="n">cells</span>
</pre></div>
</div>
<p>And a Simulation container.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">synergine.synergy.Simulation</span> <span class="kn">import</span> <span class="n">Simulation</span>


<span class="k">class</span> <span class="nc">LifeGameSimulation</span><span class="p">(</span><span class="n">Simulation</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Life game simulation container.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>  <span class="c"># Nothing to do here</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h3>Additional features<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>According to our additional features:</p>
<div class="highlight-python"><div class="highlight"><pre>In additional of &quot;Conway&#39;s Game of Life&quot; rules, we will represent differently in our 2d graphic output:

* A just born cell
* A born cell since 2 cycles
* A born cell since more 2 cycles
</pre></div>
</div>
<p>We must add an Action who have to increment age of alive cells:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">synergine.synergy.event.Action</span> <span class="kn">import</span> <span class="n">Action</span>
<span class="kn">from</span> <span class="nn">lifegame.synergy.event.TimePassEvent</span> <span class="kn">import</span> <span class="n">TimePassEvent</span>
<span class="kn">from</span> <span class="nn">lifegame.synergy.event.DieAction</span> <span class="kn">import</span> <span class="n">DieAction</span>
<span class="kn">from</span> <span class="nn">lifegame.synergy.event.BornAction</span> <span class="kn">import</span> <span class="n">BornAction</span>


<span class="k">class</span> <span class="nc">TimePassAction</span><span class="p">(</span><span class="n">Action</span><span class="p">):</span>

    <span class="n">_listen</span> <span class="o">=</span> <span class="n">TimePassEvent</span>
    <span class="sd">&quot;&quot;&quot;This action listen the TimePassEvent&quot;&quot;&quot;</span>
    <span class="n">_depend</span> <span class="o">=</span> <span class="p">[</span><span class="n">BornAction</span><span class="p">,</span> <span class="n">DieAction</span><span class="p">]</span>
    <span class="sd">&quot;&quot;&quot;This action need to be executed after Born and Die action&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">synergy_manager</span><span class="p">):</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">end_cycle</span><span class="p">()</span>
</pre></div>
</div>
<p>Who listen a simple event:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">synergine.synergy.event.Event</span> <span class="kn">import</span> <span class="n">Event</span>
<span class="kn">from</span> <span class="nn">lifegame.cst</span> <span class="kn">import</span> <span class="n">COL_ALL</span>


<span class="k">class</span> <span class="nc">TimePassEvent</span><span class="p">(</span><span class="n">Event</span><span class="p">):</span>

    <span class="n">concern</span> <span class="o">=</span> <span class="n">COL_ALL</span>
    <span class="sd">&quot;&quot;&quot;All cell are concerned&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="p">{}):</span>
        <span class="c"># All cells are concerned</span>
        <span class="k">return</span> <span class="n">parameters</span>
</pre></div>
</div>
</div>
<div class="section" id="simple-terminal">
<h3>Simple terminal<a class="headerlink" href="#simple-terminal" title="Permalink to this headline">¶</a></h3>
<p>All needed algorithms are here. To be able to see something, we write a very simple output like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">synergine.core.connection.Terminal</span> <span class="kn">import</span> <span class="n">Terminal</span>


<span class="k">class</span> <span class="nc">PrintTerminal</span><span class="p">(</span><span class="n">Terminal</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A very simple Terminal to see how many cells are alive and dead.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">receive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actions_done</span><span class="p">):</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_synergy_manager</span><span class="o">.</span><span class="n">get_objects</span><span class="p">()</span>
        <span class="n">alive_objects</span> <span class="o">=</span> <span class="p">[</span><span class="n">obj</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objects</span> <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">is_alive</span><span class="p">()]</span>
        <span class="n">died_objects</span> <span class="o">=</span> <span class="p">[</span><span class="n">obj</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objects</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">obj</span><span class="o">.</span><span class="n">is_alive</span><span class="p">()]</span>
        <span class="n">cycle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="o">.</span><span class="n">get_cycle</span><span class="p">()</span>

        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Cycle </span><span class="si">%d</span><span class="s">: </span><span class="si">%d</span><span class="s"> cells alive, </span><span class="si">%d</span><span class="s"> cells died.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cycle</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">alive_objects</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">died_objects</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="section" id="let-s-go">
<h3>Let&#8217;s go<a class="headerlink" href="#let-s-go" title="Permalink to this headline">¶</a></h3>
<p>We now need to prepare configuration and run script for our simulation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">getcwd</span>
<span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">path</span> <span class="k">as</span> <span class="n">ppath</span>
<span class="kn">from</span> <span class="nn">synergine.core.Core</span> <span class="kn">import</span> <span class="n">Core</span>

<span class="c"># For now we update the python path. It will change in future version.</span>
<span class="n">ppath</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">getcwd</span><span class="p">()</span><span class="o">+</span><span class="s">&#39;/modules&#39;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">lifegame.PrintTerminal</span> <span class="kn">import</span> <span class="n">PrintTerminal</span>
<span class="kn">from</span> <span class="nn">lifegame.synergy.collection.LifeGameCollection</span> <span class="kn">import</span> <span class="n">LifeGameCollection</span>
<span class="kn">from</span> <span class="nn">lifegame.synergy.LifeGameSimulation</span> <span class="kn">import</span> <span class="n">LifeGameSimulation</span>
<span class="kn">from</span> <span class="nn">lifegame.synergy.collection.LifeGameCollectionConfiguration</span> <span class="kn">import</span> <span class="n">LifeGameCollectionConfiguration</span>
<span class="kn">from</span> <span class="nn">xyzworld.Context</span> <span class="kn">import</span> <span class="n">Context</span> <span class="k">as</span> <span class="n">XyzContext</span>

<span class="c"># For now we update the python path. It will change in future version.</span>
<span class="n">ppath</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">getcwd</span><span class="p">()</span><span class="o">+</span><span class="s">&#39;/modules&#39;</span><span class="p">)</span>

<span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;app&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&#39;LifeGame simulation&#39;</span><span class="p">,</span>
        <span class="s">&#39;classes&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&#39;Context&#39;</span><span class="p">:</span> <span class="n">XyzContext</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s">&#39;engine&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&#39;fpsmax&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s">&#39;simulations&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">LifeGameSimulation</span><span class="p">([</span><span class="n">LifeGameCollection</span><span class="p">(</span><span class="n">LifeGameCollectionConfiguration</span><span class="p">())])],</span>
    <span class="s">&#39;connections&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">PrintTerminal</span><span class="p">]</span>
<span class="p">}</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="c"># Run simulation</span>
    <span class="n">Core</span><span class="o">.</span><span class="n">start_core</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">modules_path</span><span class="o">=</span><span class="s">&#39;modules&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We execute script and, tadaaa:</p>
<div class="highlight-python"><div class="highlight"><pre>python3.4 run_lifegame.py
Cycle 0: 7 cells alive, 1993 cells died.
Cycle 1: 7 cells alive, 1993 cells died.
Cycle 2: 9 cells alive, 1991 cells died.
Cycle 3: 9 cells alive, 1991 cells died.
Cycle 4: 10 cells alive, 1990 cells died.
Cycle 5: 12 cells alive, 1988 cells died.
Cycle 6: 11 cells alive, 1989 cells died.
Cycle 7: 16 cells alive, 1984 cells died.
Cycle 8: 15 cells alive, 1985 cells died.
Cycle 9: 23 cells alive, 1977 cells died.
Cycle 10: 20 cells alive, 1980 cells died.
</pre></div>
</div>
</div>
</div>
<div class="section" id="outputs">
<h2>Outputs<a class="headerlink" href="#outputs" title="Permalink to this headline">¶</a></h2>
<div class="section" id="d-pygame">
<h3>2D pygame<a class="headerlink" href="#d-pygame" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center">
<img alt="_images/synergine_lifegame.gif" src="_images/synergine_lifegame.gif" />
<p class="caption">LifeGame simulation capture of 2D pygame output.</p>
</div>
</div>
<div class="section" id="curses">
<h3>Curses<a class="headerlink" href="#curses" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="plot">
<h3>Plot<a class="headerlink" href="#plot" title="Permalink to this headline">¶</a></h3>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">HowTo Project: LifeGame</a><ul>
<li><a class="reference internal" href="#objective">Objective</a></li>
<li><a class="reference internal" href="#content-of-simulation">Content of simulation</a><ul>
<li><a class="reference internal" href="#simulation">Simulation</a></li>
<li><a class="reference internal" href="#additional-features">Additional features</a></li>
<li><a class="reference internal" href="#synergyobjects">SynergyObjects</a></li>
<li><a class="reference internal" href="#events-and-actions">Events and Actions</a><ul>
<li><a class="reference internal" href="#alivearoundevent">AliveAroundEvent</a></li>
<li><a class="reference internal" href="#born">Born</a></li>
<li><a class="reference internal" href="#die">Die</a></li>
<li><a class="reference internal" href="#aroundmechanism">AroundMechanism</a></li>
</ul>
</li>
<li><a class="reference internal" href="#collection">Collection</a></li>
<li><a class="reference internal" href="#id2">Additional features</a></li>
<li><a class="reference internal" href="#simple-terminal">Simple terminal</a></li>
<li><a class="reference internal" href="#let-s-go">Let&#8217;s go</a></li>
</ul>
</li>
<li><a class="reference internal" href="#outputs">Outputs</a><ul>
<li><a class="reference internal" href="#d-pygame">2D pygame</a></li>
<li><a class="reference internal" href="#curses">Curses</a></li>
<li><a class="reference internal" href="#plot">Plot</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="Components.html"
                        title="previous chapter">Components</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="BuiltinModules.html"
                        title="next chapter">Builtin Modules</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/LifeGame.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="BuiltinModules.html" title="Builtin Modules"
             >next</a> |</li>
        <li class="right" >
          <a href="Components.html" title="Components"
             >previous</a> |</li>
        <li><a href="index.html">Synergine 0.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, Bastien Sevajol.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>